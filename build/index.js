(()=>{"use strict";const e=window.React,i=window.wp.i18n,t=window.wp.primitives,d=window.ReactJSXRuntime,s=(0,d.jsxs)(t.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:[(0,d.jsx)(t.Path,{d:"m7 6.5 4 2.5-4 2.5z"}),(0,d.jsx)(t.Path,{fillRule:"evenodd",clipRule:"evenodd",d:"m5 3c-1.10457 0-2 .89543-2 2v14c0 1.1046.89543 2 2 2h14c1.1046 0 2-.8954 2-2v-14c0-1.10457-.8954-2-2-2zm14 1.5h-14c-.27614 0-.5.22386-.5.5v10.7072l3.62953-2.6465c.25108-.1831.58905-.1924.84981-.0234l2.92666 1.8969 3.5712-3.4719c.2911-.2831.7545-.2831 1.0456 0l2.9772 2.8945v-9.3568c0-.27614-.2239-.5-.5-.5zm-14.5 14.5v-1.4364l4.09643-2.987 2.99567 1.9417c.2936.1903.6798.1523.9307-.0917l3.4772-3.3806 3.4772 3.3806.0228-.0234v2.5968c0 .2761-.2239.5-.5.5h-14c-.27614 0-.5-.2239-.5-.5z"})]}),n=window.wp.editor,a=window.wp.components,o=window.wp.plugins,r=window.wp.data,c=window.wp.blockEditor,l=window.wp.coreData,{mediaThreshold:m}=window.mediaWeightData,h="hm-media-weight",g=h,u=e=>e.reduce(((e,i)=>(["core/image","core/video"].includes(i.name)&&e.push(i),i.innerBlocks?e.concat(u(i.innerBlocks)):e)),[]);(0,o.registerPlugin)(h,{icon:s,render:(...t)=>{const{attachments:s,featuredImageId:o,blocksByAttributeId:h,imageCount:p,videoCount:w}=(()=>{const i=(0,r.useSelect)((e=>e(c.store).getBlocks())),t=(0,r.useSelect)((e=>e("core/editor").getEditedPostAttribute("featured_media"))),{imageIds:d,videoIds:s,blocksByAttributeId:n}=(0,e.useMemo)((()=>{const e=u(i),d=[],s=[],n={};for(let i of e)i.attributes?.id&&(n[i.attributes.id]=i.clientId,"core/image"===i.name?d.push(i.attributes.id):"core/video"===i.name&&s.push(i.attributes.id));return 0!==t&&d.push(t),{imageIds:d,videoIds:s,blocksByAttributeId:n}}),[i,t]),a=(0,l.useEntityRecords)("postType","attachment",{per_page:d.length,include:d})?.records||[],o=(0,l.useEntityRecords)("postType","attachment",{per_page:s.length,include:s})?.records||[];return{attachments:a.concat(o),featuredImageId:t,blocksByAttributeId:n,imageCount:d.length,videoCount:s.length}})(),{selectBlock:x}=(0,r.useDispatch)(c.store);let _=0,j=0;const b=({imagesSize:e,videosSize:t})=>{const s=(e+t).toFixed(2);let n;n=s>=0&&s<=m/2?"#1db231":s>=m/2&&s<=m?"#da6201":"#cf2e2e";const a=s>=m?(0,d.jsx)("p",{className:"description",children:(0,i.sprintf)((0,i.__)("Warning! The media in this page exceeds the recommended threshold of %fmb","hm-media-weight"),m)}):null;return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("p",{children:[(0,i.__)("Images total","hm-media-weight"),": ",e.toFixed(2),"mb"]}),(0,d.jsxs)("p",{children:[(0,i.__)("Videos total","hm-media-weight"),": ",t.toFixed(2),"mb"]}),(0,d.jsx)("p",{children:(0,d.jsxs)("strong",{children:[(0,i.__)("Total media size","hm-media-weight"),": "," ",(0,d.jsxs)("span",{style:{backgroundColor:n,borderRadius:"2px",color:"#fff",padding:"3px 6px"},children:[s,"mb"]})]})}),a]})};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(n.PluginSidebarMoreMenuItem,{target:g,children:(0,i.__)("Media Weight sidebar","hm-media-weight")}),(0,d.jsxs)(n.PluginSidebar,{className:g,name:g,title:(0,i.__)("Media Weight","hm-media-weight"),children:[(0,d.jsxs)(a.PanelBody,{initialOpen:!1,title:(0,i.__)("Total Media Items","hm-media-weight"),children:[(0,d.jsxs)("p",{children:["Images: ",p]}),(0,d.jsxs)("p",{children:["Videos: ",w]})]}),(0,d.jsx)(a.PanelBody,{initialOpen:!1,title:(0,i.__)("Individual Media Items","hm-media-weight"),children:s.map((e=>{const t=e.id!==o?(0,d.jsx)(a.Button,{className:"components-button is-compact is-secondary",onClick:()=>x(h[e.id]),children:(0,i.__)("Select associated block","hm-media-weight")}):"";let s="image"===e.media_type?(0,i.__)("Image","hm-media-weight"):(0,i.__)("Video","hm-media-weight");e.id===o&&(s=(0,i.__)("Featured image","hm-media-weight"));const n=e.media_details.filesize/1e6;return"image"===e.media_type?_+=n:j+=n,(0,d.jsx)(a.PanelRow,{children:(0,d.jsxs)("div",{children:[(0,d.jsx)("p",{children:(0,d.jsxs)("strong",{children:[s,": ",n.toFixed(2),"mb"]})}),(0,d.jsxs)("p",{children:["Attachment ID: ",e.id,(0,d.jsx)("br",{}),(0,d.jsx)("small",{children:(0,d.jsx)("a",{href:e.link,children:"Go to the attachment post â€º"})})]}),(0,d.jsxs)("details",{style:{margin:"0.5rem 0 1rem"},children:[(0,d.jsx)("summary",{children:(0,i.__)("View entity record JSON","hm-media-weight")}),(0,d.jsx)("small",{children:(0,d.jsx)("pre",{children:JSON.stringify(e,null,2)})})]}),t,(0,d.jsx)("hr",{})]})},`media-details-${e.id}`)}))}),(0,d.jsx)(a.PanelBody,{initialOpen:!0,title:(0,i.__)("Total Media Size","hm-media-weight"),children:(0,d.jsx)(b,{imagesSize:_,videosSize:j})})]})]})}})})();